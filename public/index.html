<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SmartBiz Assistant</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
</head>ü§ñ
<body>


<div class="chat-header">
  <img src="Screenshot_20251218_081232_Chrome.png" class="logo" alt="Company Logo" />
  <h2>AI-_-GROW</h2>
  <p>Your digital sales assistant</p>
</div>


    <div class="chat-box" id="chatBox"></div>

    <div class="chat-input">
      <input type="text" id="userInput" placeholder="Type your message..." />
      <button onclick="sendMessage()">Send</button>

    </div>
     <button id="changeBusinessBtn">Change Business</button>
  </div>

<script>

window.onload = () => {
  addMessage(
    "üëã Welcome to AI-_-GROW!\n\Let's Grow your Business Together.\n\What can we Build / Fix for you today? Pick a number\n1Ô∏è: Website/HTML/CSS/JS/\n2Ô∏è: Land Page\n3Ô∏è: Chatbot/ AI Customer Support Automation\n4Ô∏è: other",
    "bot"
  );
};


const chatBox = document.getElementById("chatBox");

let businessType = null;
function addMessage(text, sender) {
  const msg = document.createElement("div");
  msg.className = `message ${sender}`;
  msg.textContent = text;
  chatBox.appendChild(msg);
  chatBox.scrollTop = chatBox.scrollHeight;
}

function addOptions(options) {
  const wrapper = document.createElement("div");
  wrapper.className = "options";

  options.forEach(text => {
    const btn = document.createElement("button");
    btn.className = "option-btn";
    btn.textContent = text;
    btn.onclick = () => handleOptionClick(text);
    wrapper.appendChild(btn);
  });

  chatBox.appendChild(wrapper);
  chatBox.scrollTop = chatBox.scrollHeight;
}

function handleOptionClick(text) {
  console.log("Button clicked:", text);
  sendMessage(text);
}



async function sendMessage(forcedMessage = null) {
  const input = document.getElementById("userInput");
  const message = forcedMessage || input.value.trim();

  if (!message) return;

  console.log("Sending message:", message);

  addMessage(message, "user");
  input.value = "";



  // STEP 1: Capture business type
  if (!businessType) {
    if (message === "1") businessType = "Website/HTML/CSS/JS";
    else if (message === "2") businessType = "Landing Page";
    else if (message === "3") businessType = "Chatbot";
    else if (message === "4") businessType = "other";
    else {
      addMessage("Please choose 1, 2, 3, or 4.", "bot");
      return;
    }

    addMessage(`‚úÖ Setup complete.`, "bot");
    showBusinessOptions(businessType);


   function showBusinessOptions(type) {
   if (type === "Landing Page") {
     addMessage("Welcome to Animations Landing Page! How can I help?", "bot");
     addOptions([
       "Do you want a Landing Page?",
       "Landing Page Speed Booster/Mobile UX?",
        "Responsive Landing Page Tester?",
        "Landing Page Audit?",
        "other?"
      ]);
    }

    if (type === "Website/HTML/CSS/JS") {
     addMessage("Welcome to Website/HTML//CSS/JS Issues! How can I help?", "bot");
      addOptions([
       "Websites?",
       "HTML/CSS/JS",
       "other?"
      ]);
    }

    if (type === "Chatbot") {
     addMessage( "Welcome to Chatbot/ AI Customer Support Automation! What can we build for you?", "bot");
      addOptions([
       "OpenAI ChatGPT Integration?",
       "Tidio Chatbot?",
       "Custom JS Bot?",
       "DialogFlow(Google)?",
       "other?"
      ]);
    }

    if (type === "other") {
     addMessage("‚öñÔ∏è Welcome! Click contact to find our contact? Email or Call !", "bot");
      addOptions([
       "Contact?"
      ]);
    }
  }
 }

  // Send to server
  try {
    const res = await fetch("/chat", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ message, businessType })
    });

    if (!res.ok) throw new Error("Server error");

    const data = await res.json();
    addMessage(data.reply, "bot");

  } catch (err) {
    console.error(err);
    addMessage("‚ö†Ô∏è Connection error.", "bot");
  }
}
</script>
</body>
</html>
